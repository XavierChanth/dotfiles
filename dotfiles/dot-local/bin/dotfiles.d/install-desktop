#!/bin/bash

command_exists() {
  command -v "$1" >/dev/null 2>&1
}

case "$(uname)" in
  Darwin)
    if command_exists brew; then
      echo "brew package manager found, installing packages for brew"

      # core apps
      brew install zen-browser google-chrome qutebrowser
      brew install zoom discord spotify
      brew install betterdisplay cleanshot unnaturalscrollwheels
      # desktop essentials
      brew tap felixkratz/formulae
      brew install aerospace sketchybar dmenu-mac bitwarden-cli

      # terminal stuff
      brew install wezterm asciinema
      brew install font-jetbrains-mono-nerd-font
      brew install aerc abook pandoc
      brew install ffmpegthumbnailer unar poppler
    fi
    ;;
  Linux)
    if command_exists dnf; then
      echo "dnf package manager found, installing packages for dnf"

      sudo dnf install -y wezterm
      sudo dnf install -y aerc abook
    fi
    ;;
esac

# install wezterm terminfo
tempfile="$(mktemp)"
if [ -n "$tempfile" ]; then
  curl -o "$tempfile" "https://raw.githubusercontent.com/wez/wezterm/master/termwiz/data/wezterm.terminfo"
  tic -x -o ~/.terminfo "$tempfile"
fi

# if [ $(uname) = 'Darwin']; then
#   git clone git@github.com:unmanbearpig/unmenu.git $HOME/.local/lib/unmenu
#   (
#     cd $$OME/.local/lib/unmenu
#     make
#     cp -r build/Build/Products/Release/unmenu.app /Applications
#   )
# fi

[ -n "$tempfile" ] && rm "$tempfile"
